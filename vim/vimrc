" Both required for Vundle 
set nocompatible
filetype off

" Set the runtime path to include Vundle and initialize
set rtp+=~/.vim/bundle/Vundle.vim
call vundle#begin()

" Let Vundle manage Vundle, required
Plugin 'VundleVim/Vundle.vim'

" Plugins
Plugin 'yuezk/vim-js'
Plugin 'pangloss/vim-javascript'
Plugin 'leafgarland/typescript-vim'
Plugin 'maxmellon/vim-jsx-pretty'
Plugin 'neoclide/coc.nvim', {'branch': 'release'}
Plugin 'styled-components/vim-styled-components'
Plugin 'arcticicestudio/nord-vim'
Plugin 'dracula/vim', {'name': 'dracula'}
Plugin 'itchyny/lightline.vim'
Plugin 'Vimjas/vim-python-pep8-indent'
Plugin 'pappasam/coc-jedi', { 'do': 'yarn install --frozen-lockfile && yarn build' }
Plugin 'vim-python/python-syntax'

" All Plugins must be above this line
call vundle#end()
filetype plugin indent on

" Set color scheme
colorscheme dracula
" Disable holding movement keys
:noremap hh <nop>
:noremap jj <nop>
:noremap kk <nop>
:noremap ll <nop>

" Hide default status line
set noshowmode

" Search down into subfolders
" Provide tab-completion for all file-related tasks
set path+=**

" Ignore node_modules for finding
set wildignore+=**/node_modules/** 

" Enable nice menu for tab completion file names
set wildmenu

" Let vim-python/python-syntax do its thing
let g:python_highlight_all = 1

" To get Dracula colors in iTerm2
set termguicolors
let g:dracula_colorterm = 0

" Move up and down by visible lines if current line is wrapped
nmap j gj
nmap k gk

" Configure indentation
set tabstop=2
set shiftwidth=2
set expandtab

" Enable syntax highlighting
syntax enable

" Keep at least 4 lines below cursor
set scrolloff=4

" Set relative line numbering with absolute number for current line
set number relativenumber

" Rapid editing of Vimrc
nmap <leader>vr :sp $MYVIMRC<cr>
nmap <leader>so :source $MYVIMRC<cr>

" CoC configuration
let g:coc_global_extensions = ['coc-react-refactor', 'coc-prettier', 'coc-eslint', 'coc-tsserver', 'coc-styled-components']
let g:coc_global_extensions = ['coc-json', 'coc-react-refactor', 'coc-prettier', 'coc-eslint', 'coc-tsserver', 'coc-styled-components', 'coc-python']
let g:coc_global_extensions = [
      \ 'coc-json',
      \ 'coc-react-refactor',
      \ 'coc-prettier',
      \ 'coc-eslint',
      \ 'coc-tsserver',
      \ 'coc-styled-components',
      \ 'coc-python'
      \ ]

" CoC actions
nmap <leader>a <Plug>(coc-codeaction)
nmap <leader>rn <Plug>(coc-rename)

" Use K to show documentation in preview window
nnoremap <silent> K :call <SID>show_documentation()<CR>

function! s:show_documentation()
  if (index(['vim','help'], &filetype) >= 0)
    execute 'h '.expand('<cword>')
  else
    call CocAction('doHover')
  endif
endfunction

" Prettier command
command! -nargs=0 Prettier :call CocAction('runCommand', 'prettier.formatFile')
